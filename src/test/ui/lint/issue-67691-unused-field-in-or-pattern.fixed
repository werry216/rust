// run-rustfix

#![feature(or_patterns)]
#![deny(unused)]

pub enum MyEnum {
    A { i: i32, j: i32 },
    B { i: i32, j: i32 },
}

pub enum MixedEnum {
    A { i: i32 },
    B(i32),
}

pub fn no_ref(x: MyEnum) {
    use MyEnum::*;

    match x {
        A { i, j: _ } | B { i, j: _ } => { //~ ERROR unused variable
            println!("{}", i);
        }
    }
}

pub fn with_ref(x: MyEnum) {
    use MyEnum::*;

    match x {
        A { i, j: _ } | B { i, j: _ } => { //~ ERROR unused variable
            println!("{}", i);
        }
    }
}

pub fn inner_no_ref(x: Option<MyEnum>) {
    use MyEnum::*;

    match x {
        Some(A { i, j: _ } | B { i, j: _ }) => { //~ ERROR unused variable
            println!("{}", i);
        }

        _ => {}
    }
}

pub fn inner_with_ref(x: Option<MyEnum>) {
    use MyEnum::*;

    match x {
        Some(A { i, j: _ } | B { i, j: _ }) => { //~ ERROR unused variable
            println!("{}", i);
        }

        _ => {}
    }
}

pub fn mixed_no_ref(x: MixedEnum) {
    match x {
        MixedEnum::A { i: _ } | MixedEnum::B(_) => {
            println!("match");
        }
    }
}

pub fn mixed_with_ref(x: MixedEnum) {
    match x {
        MixedEnum::A { i: _ } | MixedEnum::B(_) => {
            println!("match");
        }
    }
}

pub fn main() {
    no_ref(MyEnum::A { i: 1, j: 2 });
    with_ref(MyEnum::A { i: 1, j: 2 });

    inner_no_ref(Some(MyEnum::A { i: 1, j: 2 }));
    inner_with_ref(Some(MyEnum::A { i: 1, j: 2 }));

    mixed_no_ref(MixedEnum::B(5));
    mixed_with_ref(MixedEnum::B(5));
}
